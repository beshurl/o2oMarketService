<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.o2omystore.dao.CategoryDao">

	<resultMap id="productResultMap" type="com.ssafy.o2omystore.dto.Product">
		<id property="productId" column="product_id" />
		<result property="name" column="name" />
		<result property="price" column="price" />
		<result property="finalPrice" column="final_price" />
		<result property="image" column="image" />
		<result property="category" column="category_name" />
		<result property="stock" column="count" />
		<result property="discountRate" column="rate" />
		<result property="discountType" column="type" />
	</resultMap>

	<select id="selectProductsByCategory"
		parameterType="int"
		resultMap="productResultMap">

		SELECT
		p.product_id,
		p.name,
		p.price,
		p.count,
		p.description,
		p.image,
		p.is_discount,
		p.is_deadline_sale,
		p.deadline_at,
		c.category_name
		FROM product p
		JOIN product_category pc
		ON p.product_id = pc.product_id
		JOIN category c
		ON pc.category_id = c.category_id
		WHERE pc.category_id = #{categoryId}

	</select>


</mapper>